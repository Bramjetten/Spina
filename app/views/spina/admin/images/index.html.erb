<div data-controller="file-manager">
  <div class="relative">
    <div class="bg-white border-b border-gray-200 p-4 pb-6 md:p-6 md:pl-8 sticky top-0 z-20">
      <div class="flex justify-between items-center">
        <div class="text-xl md:text-2xl font-normal text-gray-800 flex md:items-center flex-col md:flex-row w-full">
          <div class="flex items-center">
            <div class="text-2xl font-normal text-gray-800 flex items-center">
              <%= link_to 'Images', spina.admin_images_path, class: 'text-gray-400' %>
              <% if @media_folder.present? %>
                <svg class="w-5 h-5 mx-2 text-gray-300" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                </svg>
                <%= @media_folder.name %>
              <% end %>
            </div>
          </div>
        </div>
      </div>
      
      <nav class="-mb-3 mt-4">
        <ul class="inline-flex w-auto rounded-md bg-white">
          <button type="button" class="block px-3 leading-relaxed py-1 hover:text-gray-800 rounded-md text-gray-400 font-medium text-sm flex items-center cursor-default text-gray-900 bg-spina-dark bg-opacity-10" data-action="tabs#show" data-tabs-target="button" data-pane-id="page_content">
            <%= icon("photograph", css: "w-5 h-5 mr-2 -ml-1") %>
            Images
          </button>
          <button type="button" class="block px-3 leading-relaxed py-1 hover:text-gray-800 rounded-md text-gray-400 font-medium text-sm flex items-center" data-action="tabs#show" data-tabs-target="button" data-pane-id="page_content">
            <%= icon("document", css: "w-5 h-5 mr-2") %>
            Files
          </button>
        </ul>
      </nav>
    </div>
    
    <div class="flex p-4 z-20 absolute top-0 right-0 h-24 items-center md:pr-8">
      <%= link_to spina.new_admin_media_folder_path(format: :modal), class: "btn btn-default mr-3", data: {controller: "remote-modal"} do %>
        <%= icon("folder", css: 'w-4 h-4 mr-1 -ml-1') %>
        Add folder
      <% end %>
      <%= form_with model: [:admin, Spina::Image.new], url: spina.admin_images_path(format: :html), data: {action: "ajax:success->file-manager#uploaded", file_manager_target: "uploadForm"} do |f| %>
        <%= f.hidden_field :media_folder_id, value: @media_folder&.id %>
        <%= f.file_field :files, multiple: true, accept: "image/*", class: 'hidden', data: {action: "file-manager#startUpload", file_manager_target: "fileField"} %>
        
        <button type="button" class="btn btn-default" data-action="file-manager#chooseFiles" data-file-manager-target="uploadButton" data-controller="button" data-loading-message="Uploading...">
          <%= icon("upload", css: "w-4 h-4 -ml-1 mr-1") %>
          <%=t 'spina.images.upload' %>
        </button>
      <% end %>
    </div>
  </div>
  
  <div class="my-8 border-t border-gray-200">
    
    <% if @media_folder.present? %>
      <div class="flex items-center h-12 hover:bg-white border-b border-gray-200 px-8">
        <%= link_to spina.admin_images_path, class: 'flex h-full items-center flex-1' do %>
          <div class="w-8 mr-4 flex justify-center">
            <%= icon("collection", css: "w-7 h-7 text-spina") %>
          </div>
          <div class="font-medium text-spina flex-1 text-sm">
            Back to all
          </div>
        <% end %>
      </div>
    <% else %>
      <% @media_folders.each do |media_folder| %>
        <div data-file-manager-target="media-folder" class="flex items-center h-12 hover:bg-white border-b border-gray-200 px-8">
          <%= link_to spina.admin_media_folder_images_path(media_folder), class: 'flex h-full items-center flex-1' do %>
            <div class="w-8 mr-4 flex justify-center"><%= icon("folder", css: "w-7 h-7 text-spina") %></div>
            <div class="font-medium text-spina flex-1 text-sm">
              <%= media_folder.name %>
            </div>
          <% end %>
          <div class="text-gray-500 text-sm">
            <span><%= media_folder.images.size %></span>
            images
          </div>
          <div class="text-gray-500 text-xs w-32 text-right"><%=l media_folder.created_at, format: :short %></div>
          
          <%= link_to spina.admin_media_folder_path(media_folder), class: "block py-3 px-4 ml-2 text-gray-500 hover:text-gray-900", data: {method: :delete, controller: "confirm", confirm_message: "Are you sure? Images will <strong>not</strong> be deleted."} do %>
            <%= icon('trash', css: 'w-5 h-5') %>
          <% end %>
        </div>
      <% end %>
    <% end %>
    
    <div data-file-manager-target="images" data-controller="infinite-scroll" data-infinite-scroll-path="<%= spina.admin_file_manager_images_path(page: 1, media_folder_id: @media_folder&.id) %>" data-infinite-scroll-target="container">
      <!-- Images -->
    </div>
  
  </div>
</div>